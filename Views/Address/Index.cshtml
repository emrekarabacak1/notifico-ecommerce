@model IEnumerable<Notifico.Models.Address>
@{
    ViewData["Title"] = "Adreslerim";
}
<h2 class="mb-4">Adreslerim</h2>

<a asp-action="Add" class="btn btn-primary mb-3">+ Yeni Adres Ekle</a>

@if (Model == null || !Model.Any())
{
    <div class="alert alert-info mt-4">Henüz kayıtlı adresiniz yok.</div>
}
else
{
    <div class="table-responsive">
        <table class="table align-middle table-bordered table-hover">
            <thead>
                <tr>
                    <th>Başlık</th>
                    <th>Adres</th>
                    <th>Şehir</th>
                    <th>İlçe</th>
                    <th class="text-center">Varsayılan</th>
                    <th class="text-center">İşlem</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var a in Model)
                {
                    <tr>
                        <td>@a.Title</td>
                        <td style="max-width:220px;word-break:break-word;">@a.FullAddress</td>
                        <td>@a.City</td>
                        <td>@a.District</td>
                        <td class="text-center">
                            @if (a.IsDefault)
                            {
                                <span class="badge bg-success px-3 py-2">Varsayılan</span>
                            }
                            else
                            {
                                <form asp-action="SetDefault" method="post" style="display:inline;" asp-route-id="@a.Id">
                                    @Html.AntiForgeryToken()
                                    <button class="btn btn-outline-secondary btn-sm" type="submit" title="Varsayılan Yap">
                                        Yap
                                    </button>
                                </form>
                            }
                        </td>
                        <td class="text-center">
                            <a asp-action="Edit" asp-route-id="@a.Id" class="btn btn-warning btn-sm me-1">Düzenle</a>
                            <form asp-action="Delete" method="post" style="display:inline;" asp-route-id="@a.Id">
                                @Html.AntiForgeryToken()
                                <button class="btn btn-danger btn-sm" type="submit"
                                        onclick="return confirm('Bu adres silinsin mi?');">
                                    Sil
                                </button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}

@section Scripts {
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script>
        $(function () {
        @if (ViewBag.Success != null)
        {
            <text>toastr.success("@ViewBag.Success", "Başarılı", { timeOut: 2000 }); </text>
        }
        @if (ViewBag.Error != null)
        {
            <text>toastr.error("@ViewBag.Error", "Hata", { timeOut: 2500 }); </text>
        }
                });
    </script>
}
