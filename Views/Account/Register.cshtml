@model Notifico.Models.RegisterViewModel

@{
    ViewData["Title"] = "Kayıt Ol";
}

<style>
    body, html {
        height: 100%;
        margin: 0;
        padding: 0;
    }

    .register-page-single-bg {
        min-height: 100vh;
        background: #f7fafd;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: row;
    }

    .register-left-panel, .register-form-panel {
        background: none !important;
        box-shadow: none !important;
    }

    .register-left-panel {
        flex: 1.05;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        min-width: 250px;
        max-width: 440px;
        padding-right: 3vw;
    }

    .register-left-content {
        max-width: 350px;
        padding: 2.2rem 2rem 2rem 0;
    }

    .register-logo {
        font-size: 2.1rem;
        font-weight: bold;
        color: #2563eb;
        margin-bottom: 1.3rem;
        letter-spacing: -0.03em;
        display: flex;
        align-items: center;
        gap: 0.7rem;
    }

    .register-title {
        font-size: 2.1rem;
        font-weight: 800;
        color: #183261;
        margin-bottom: 0.8rem;
        letter-spacing: -0.02em;
        line-height: 1.1;
    }

    .register-desc {
        font-size: 1.1rem;
        color: #68749b;
        font-weight: 500;
        margin-bottom: 0.2rem;
    }

    .register-form-panel {
        flex: 2;
        display: flex;
        align-items: center;
        justify-content: flex-start;
        min-width: 320px;
        padding-left: 3vw;
    }

    .register-form-inner {
        width: 100%;
        max-width: 570px;
        margin: 2vw auto;
    }

    .form-row {
        display: flex;
        gap: 1.1rem;
    }

    .form-group {
        margin-bottom: 1.15rem;
        flex: 1 1 0;
        display: flex;
        flex-direction: column;
    }

    label {
        font-weight: 600;
        color: #37446d;
        font-size: 1rem;
        margin-bottom: 0.23rem;
    }

    .form-control, .form-select, textarea {
        border-radius: 0.8rem;
        border: 1.4px solid #d4e0f5;
        font-size: 1rem;
        padding: 0.7rem 1.1rem;
        background: #fcfcff;
        transition: border .15s;
    }

        .form-control:focus, .form-select:focus, textarea:focus {
            border-color: #7aa7e7;
            box-shadow: 0 0 0 2px #e5f0ff;
            background: #f4f9ff;
        }

    .text-danger {
        font-size: 0.93rem;
    }

    .register-submit-row {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        margin-top: 2rem;
        gap: 1.3rem;
        flex-wrap: wrap;
    }

    .register-btn {
        background: #2563eb;
        color: #fff;
        border-radius: 2rem;
        padding: 0.8rem 2.5rem;
        font-size: 1.09rem;
        font-weight: 700;
        border: none;
        transition: background .18s;
        box-shadow: 0 2px 10px 0 rgba(47,101,208,0.09);
    }

        .register-btn:hover {
            background: #153265;
        }

    .register-login-link {
        color: #2563eb;
        font-weight: 600;
        font-size: 1.06rem;
        text-decoration: none;
        padding: 0.5rem 1.2rem;
        border-radius: 1.2rem;
        transition: background 0.18s, color 0.18s;
    }

        .register-login-link:hover {
            background: #eaf2ff;
            color: #153265;
            text-decoration: underline;
        }

    media (max-width: 1100px) {
        .register-left-panel, .register-form-panel

    {
        padding-right: 1vw;
        padding-left: 1vw;
    }

    .register-form-inner {
        max-width: 95vw;
    }

    }

    media (max-width: 900px) {
        .register-page-single-bg

    {
        flex-direction: column;
    }

    .register-left-panel, .register-form-panel {
        min-width: 0;
        max-width: 100vw;
        padding: 0;
        justify-content: center;
    }

    .register-left-content {
        padding: 2.2rem 1rem 1.2rem 1rem;
        max-width: 98vw;
    }

    .register-form-inner {
        margin: 2vw auto;
    }

    }

    media (max-width: 700px) {
        .form-row

    {
        flex-direction: column;
        gap: 0.1rem;
    }

    }

    media (max-width: 500px) {
        .register-title

    {
        font-size: 1.25rem;
    }

    .register-desc {
        font-size: 0.96rem;
    }

    .register-form-inner {
        margin: 1vw auto;
    }

    }
</style>

<div class="register-page-single-bg">
    <div class="register-left-panel">
        <div class="register-left-content">
            <div class="register-logo">
                <i class="bi bi-bag-check-fill"></i>
                Notifico
            </div>
            <div class="register-title">Kayıt Ol</div>
            <div class="register-desc">
                Notifico'ya ücretsiz üye olun, kampanyaları kaçırmayın.<br>
                Tüm ayrıcalıklar için hemen hesabınızı oluşturun!
            </div>
        </div>
    </div>
    <div class="register-form-panel">
        <div class="register-form-inner">
            <form asp-action="Register" method="post" autocomplete="off">
                @Html.AntiForgeryToken()
                <div class="form-row">
                    <div class="form-group">
                        <label asp-for="FirstName">Ad</label>
                        <input asp-for="FirstName" class="form-control" placeholder="Adınız" />
                        <span asp-validation-for="FirstName" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="LastName">Soyad</label>
                        <input asp-for="LastName" class="form-control" placeholder="Soyadınız" />
                        <span asp-validation-for="LastName" class="text-danger"></span>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label asp-for="UserName">Kullanıcı Adı</label>
                        <input asp-for="UserName" class="form-control" autocomplete="username" placeholder="Kullanıcı adı" />
                        <span asp-validation-for="UserName" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="Email">E-posta</label>
                        <input asp-for="Email" class="form-control" autocomplete="email" placeholder="E-posta adresi" />
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label asp-for="Password">Şifre</label>
                        <input asp-for="Password" class="form-control" type="password" autocomplete="new-password" placeholder="Şifreniz" />
                        <span asp-validation-for="Password" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="PhoneNumber">Telefon Numarası</label>
                        <input asp-for="PhoneNumber" class="form-control" autocomplete="tel" placeholder="05xx xxx xx xx" />
                        <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label asp-for="BirthDate">Doğum Tarihi</label>
                        <input asp-for="BirthDate" class="form-control" type="date" placeholder="gg.aa.yyyy" />
                        <span asp-validation-for="BirthDate" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="City">İl</label>
                        <select id="citySelect" name="City" asp-for="City" class="form-select">
                            <option value="">-- İl seçiniz --</option>
                        </select>
                        <span asp-validation-for="City" class="text-danger"></span>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label asp-for="District">İlçe</label>
                        <select id="districtSelect" name="District" asp-for="District" class="form-select">
                            <option value="">-- İlçe seçiniz --</option>
                        </select>
                        <span asp-validation-for="District" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="Address">Adres</label>
                        <textarea asp-for="Address" class="form-control" placeholder="Adresiniz"></textarea>
                        <span asp-validation-for="Address" class="text-danger"></span>
                    </div>
                </div>
                <div class="register-submit-row">
                    <button type="submit" class="register-btn">Kayıt Ol</button>
                    <a asp-action="Login" asp-controller="Account" class="register-login-link">Giriş Yap</a>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        let cityDistrictData = [];
        function fillCities(selectedCity) {
            var citySelect = document.getElementById('citySelect');
            citySelect.innerHTML = '<option value="">-- İl seçiniz --</option>';
            cityDistrictData.forEach(function (city) {
                var option = document.createElement('option');
                option.value = city.text;
                option.text = city.text;
                if (selectedCity && selectedCity === city.text) {
                    option.selected = true;
                }
                citySelect.appendChild(option);
            });
        }
        function fillDistricts(cityName, selectedDistrict) {
            var districtSelect = document.getElementById('districtSelect');
            districtSelect.innerHTML = '<option value="">-- İlçe seçiniz --</option>';
            var city = cityDistrictData.find(function (c) { return c.text === cityName; });
            if (!city) return;
            city.districts.forEach(function (district) {
                var option = document.createElement('option');
                option.value = district.text;
                option.text = district.text;
                if (selectedDistrict && selectedDistrict === district.text) {
                    option.selected = true;
                }
                districtSelect.appendChild(option);
            });
        }
        document.addEventListener("DOMContentLoaded", function () {
            fetch('/data/cityDistricts.json')
                .then(response => response.json())
                .then(data => {
                    cityDistrictData = data;
                    var initialCity = '@(Model.City ?? "")';
                    var initialDistrict = '@(Model.District ?? "")';
                    fillCities(initialCity);
                    if (initialCity) fillDistricts(initialCity, initialDistrict);
                    document.getElementById('citySelect').addEventListener('change', function () {
                        fillDistricts(this.value, null);
                    });
                })
                .catch(error => {
                    console.error("Şehir-ilçe verisi yüklenemedi:", error);
                });
        });
    </script>
}
